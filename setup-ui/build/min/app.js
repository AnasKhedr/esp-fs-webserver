const svgLock='<svg height="16pt" viewBox="0 0 512 512"><path d="m336 512h-288c-26.453125 0-48-21.523438-48-48v-224c0-26.476562 21.546875-48 48-48h288c26.453125 0 48 21.523438 48 48v224c0 26.476562-21.546875 48-48 48zm-288-288c-8.8125 0-16 7.167969-16 16v224c0 8.832031 7.1875 16 16 16h288c8.8125 0 16-7.167969 16-16v-224c0-8.832031-7.1875-16-16-16zm0 0"/><path d="m304 224c-8.832031 0-16-7.167969-16-16v-80c0-52.929688-43.070312-96-96-96s-96 43.070312-96 96v80c0 8.832031-7.167969 16-16 16s-16-7.167969-16-16v-80c0-70.59375 57.40625-128 128-128s128 57.40625 128 128v80c0 8.832031-7.167969 16-16 16zm0 0"/></svg>',svgUnlock='<svg height="16pt" viewBox="0 0 512 512"><path d="m336 512h-288c-26.453125 0-48-21.523438-48-48v-224c0-26.476562 21.546875-48 48-48h288c26.453125 0 48 21.523438 48 48v224c0 26.476562-21.546875 48-48 48zm-288-288c-8.8125 0-16 7.167969-16 16v224c0 8.832031 7.1875 16 16 16h288c8.8125 0 16-7.167969 16-16v-224c0-8.832031-7.1875-16-16-16zm0 0"/><path d="m80 224c-8.832031 0-16-7.167969-16-16v-80c0-70.59375 57.40625-128 128-128s128 57.40625 128 128c0 8.832031-7.167969 16-16 16s-16-7.167969-16-16c0-52.929688-43.070312-96-96-96s-96 43.070312-96 96v80c0 8.832031-7.167969 16-16 16zm0 0"/></svg>';var options={},$=function(e){return document.getElementById(e)};function showPass(){var e=document.getElementById("password");"password"===e.type?e.type="text":e.type="password"}function getWiFiList(){document.body.className="waiting";var e=new URL("http://"+`${window.location.hostname}`+"/scan");fetch(e).then(e=>e.json()).then(e=>{listWifiNetworks(e),document.body.className=""})}function selectWifi(e){try{$("select-"+e.target.parentNode.id).checked=!0}catch(t){$(e.target.id).checked=!0}$("ssid").value=this.cells[1].innerHTML,$("ssid-name").innerHTML=this.cells[1].innerHTML,$("password").focus()}function listWifiNetworks(e){const t=document.querySelector("#wifi-list");t.innerHTML="",e.forEach((e,s)=>{var n=document.createElement("tr"),i="wifi-"+s;n.id=i,n.addEventListener("click",selectWifi),n.innerHTML=`<td><input type="radio" name="select" id="select-${i}"></td>`,n.innerHTML+=`<td id="ssid-${i}">${e.ssid}</td>`,n.innerHTML+="<td>"+e.strength+"</td>",e.security?n.innerHTML+="<td>"+svgLock+"</td>":n.innerHTML+="<td>"+svgUnlock+"</td>",t.appendChild(n)}),$("wifi-table").classList.remove("hidden")}function getParameters(){var e=new URL("http://"+`${window.location.hostname}`+"/config.json");fetch(e).then(e=>e.json()).then(e=>{Object.keys(e).forEach(function(t){t.startsWith("logo-name")&&($("logo-name").innerHTML=e[t],delete e[t]),t.startsWith("logo-svg")&&($("logo-svg").innerHTML=e[t],delete e[t])}),listParameters(options=e)})}function listParameters(e){var t;for(var s in $("param-list").innerHTML="",e){if(s.startsWith("raw-html"))t=e[s].trim();else{var n=e[s],i=`width: calc(0.75rem * ${s.length}); text-align:right; padding:10px;`,a=`<input class="opt-input" id="${s}" type="${typeof n}"`;if("boolean"==typeof n){var o=!0===n?o="checked":"";t=`<label for="${s}"><input class="opt-input" type="checkbox" role="switch" id="${s}" ${o}>${s}</label>`}else{if("string"==typeof n&&(a+=` value="${n}">`),"number"==typeof n&&(a+=`  inputmode="numeric" value=${n}>`),"object"==typeof n){var c=Math.round(n.value*(1/n.step))/(1/n.step);a=`<input class="opt-input" id="${s}" type="${typeof n.value}"" inputmode="numeric" value=${c} step=${n.step} min=${n.min} max=${n.max}>`}t=`<input type="text" style="${i}" value="${s}:" disabled>${a}`}}var d=document.createElement("div");d.className="button-row",d.innerHTML=t,s.endsWith("-hidden")&&(d.className+=" hidden"),$("param-list").appendChild(d)}addInputListener(),$("params-box").classList.remove("hidden")}function addInputListener(){document.querySelectorAll(".opt-input").forEach(e=>{e.addEventListener("change",t=>{if("number"===e.type)if(e.getAttribute("step")){var s={};s.value=Math.round(100*parseFloat(e.value))/100,s.step=e.getAttribute("step"),s.min=e.getAttribute("min"),s.max=e.getAttribute("max"),options[e.id]=s}else options[e.id]=parseInt(e.value);"text"===e.type&&(options[e.id]=e.value),"checkbox"===e.type&&(options[e.id]=e.checked)})})}function closeModalMessage(){$("modal-message").classList.add("hidden")}function saveParameters(){document.body.className="waiting",console.log(options);var e=new Blob([JSON.stringify(options,null,2)],{type:"application/json"}),t=new FormData;t.append("data",e,"/config.json"),fetch("/edit",{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Access-Control-Max-Age":"600","Access-Control-Allow-Methods":"PUT,POST,GET,OPTIONS","Access-Control-Allow-Headers":"*"},body:t}).then(e=>e.text()).then(e=>{$("message-body").innerHTML="<br><b>config.json</b> file saved successfully on flash memory!<br><br>",$("modal-message").classList.remove("hidden"),document.body.className=""})}function doConnection(){var e;document.body.className="waiting";var t=new FormData;t.append("ssid",$("ssid").value),t.append("password",$("password").value),t.append("persistent",$("persistent").checked);var s=`ssid=${$("ssid").value}&password=${$("password").value}&persistent=${$("persistent").checked}`;fetch("/connect",{method:"POST",redirect:"follow",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}).then(function(t){return e=t.status,t.text()}).then(function(t){200===e&&($("message-body").innerHTML="<br>ESP connected to <b>"+$("ssid").value+"</b><br><br>",$("modal-message").classList.remove("hidden")),500===e&&($("message-body").innerHTML="<br>Error on connection: <b>"+t+"</b><br><br>",$("modal-message").classList.remove("hidden")),document.body.className=""})}window.addEventListener("load",getParameters),$("scan-wifi").addEventListener("click",getWiFiList),$("save-params").addEventListener("click",saveParameters),$("connect-wifi").disabled=!0,$("password").addEventListener("input",e=>{0===$("password").value.length?$("connect-wifi").disabled=!0:$("connect-wifi").disabled=!1});